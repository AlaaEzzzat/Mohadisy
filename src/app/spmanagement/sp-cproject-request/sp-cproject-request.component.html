<div class="section-2 mt-2">
    <div class="row">
      <div class="col-4">
        <div class="row">

          <ng-container *ngFor="let project of Listprojects|
          paginate: {itemsPerPage:5, currentPage: page }">

            <ng-container *ngIf="this.select==project.id">
              <div class="col-12 card card-1 mt-4" (click)="showData(project.id)"
                style="background:#004958; color:white;">
                <p><i class="far fa-user "></i>
                  <span>{{project.clientProfile.firstName}} {{project.clientProfile.lastName}}</span>
                  <a class="btn">تشطيب</a>
                </p>
                <p><i class="fa fa-location-dot "></i>
                  {{project.district.nameAr}},{{project.district.city.nameAr}},
                  {{project.district.city.region.nameAr}} </p>
                <p><i class="far fa-calendar-alt "></i>{{project.dateCreated}}</p>
              </div>
            </ng-container>


            <ng-container *ngIf="this.select!=project.id">
              <div class="col-12 card card-1 mt-4" (click)="showData(project.id)"
                style="background:white;  color:#004057;">
                <p><i class="far fa-user "></i>
                  <span>{{project.clientProfile.firstName}} {{project.clientProfile.lastName}}</span>
                  <a class="btn">تشطيب</a>
                </p>
                <p><i class="fa fa-location-dot "></i>
                  {{project.district.nameAr}},{{project.district.city.nameAr}},
                  {{project.district.city.region.nameAr}} </p>
                <p><i class="far fa-calendar-alt  "></i>{{project.dateCreated}}</p>
              </div>
            </ng-container>

          </ng-container>

          <div class="paginate mt-4">
            <pagination-controls (pageChange)="changepage($event)"
            previousLabel="السابق"
            nextLabel="التالى"
            >
            </pagination-controls>
          </div>


          <!--- <div class="col-12 card card-1 mt-4" >
          <p><i class="fa fa-user "></i><span>ساره عبدالعزيز</span>
            <a class="btn text-success">تشطيب</a>
          </p>
          <p><i class="fa fa-location-dot "></i>النزهه الدجديده, القاهره</p>
          <p><i class="fa fa-clock-four "></i>25/8/1-11:00am</p>
        </div>

        <div class="col-12 card card-1 mt-4">
          <p><i class="fa fa-user "></i><span>ساره عبدالعزيز</span>
            <a class="btn text-success">تشطيب</a>
          </p>
          <p><i class="fa fa-location-dot "></i>النزهه الدجديده, القاهره</p>
          <p><i class="fa fa-clock-four "></i>25/8/1-11:00am</p>
        </div>
      -->

        </div>

      </div>


      <div class="col-8  mt-4 mb-3">

        <a href="/Spmanagement/projects/all"
        class=" mb-2 return" routerLinkActive="active">الرجوع</a>

        <ng-container *ngIf="select!=0">
          <div class="row ">

            <div class="col-12 mt-3">

              <div class="card">
             <div id="accordion">
              <h2>
                <button class="btn btn-accordion w-100" type="button"
                data-target="#item1" data-toggle="collapse" >المده والتكلفه</button>
              </h2>

              <div class="collapse show" id="item1" data-parent="#accordian">

                <h6 class="dotted-line mt-2 text-center" style="color:gray;"></h6>

                <form [formGroup]="OfferData" (ngSubmit)="onSubmit()">
                  <div class="card card-3 mt-3">
                    <div class="row">

                      <input type="hidden" formControlName="projectId" name="projectId" [value]="select">

                      <div class="col-lg-12 form-group ">
                        <label for="period" class="label-control">مده المشروع</label>
                        <input type="text" class="form-control " name="period" formControlName="period" placeholder="مده المشروع" required
                      [class.is-valid]="OfferData.get('period')?.valid"
                      [class.is-invalid]="OfferData.get('period')?.invalid && OfferData.get('period')?.touched">
                        <div
                        class="alert alert-danger"
                        [hidden]="OfferData.get('period')?.valid ||OfferData.get('period')?.untouched" >
                        <span *ngIf="OfferData.get('period')?.errors?.['required']
                        " >مده المشروع مطلوبه</span>
                      </div>
                      </div>


                      <div class="col-lg-6 form-group mt-3">
                        <label for="cost" class="label-control mb-2">السعر</label>
                        <input type="number" class="form-control cost" name="cost"
                        formControlName="cost"
                         placeholder="السعر" (ngModelChange)="TotalCost()" required
                      [class.is-valid]="OfferData.get('cost')?.valid"
                      [class.is-invalid]="OfferData.get('cost')?.invalid &&
                      OfferData.get('cost')?.touched" >
                      <div
                      class="alert alert-danger"
                      [hidden]="OfferData.get('cost')?.valid ||OfferData.get('cost')?.untouched" >
                      <span *ngIf="OfferData.get('cost')?.errors?.['required']" >السعر مطلوب</span>
                    </div>

                      </div>

                      <div class="col-lg-6 form-group mt-4" >
                        <label for="cost" class="label-control mb-2"></label>
                        <input type="text" class="form-control cost" name="costAr"  [disabled]="true"
                         placeholder="السعر" >
                      </div>


                      <div class="col-lg-6 form-group mt-3">
                        <label for="cost" class="label-control mb-2">رسوم اداريه</label>
                        <input type="text" class="form-control"
                         [disabled]="true"  [disabled]="true"
                        value="%1" placeholder="%1" >
                      </div>


                      <div class="col-lg-6 form-group mt-3">
                        <label for="cost" class="label-control mb-2">اجمالى السعر</label>
                        <input type="number" class="form-control cost" name="tcost"
                        formControlName="tcost"
                         placeholder="السعر" >
                      </div>

                      <div class="col-lg-12 form-group mt-3">
                        <label for="numberOfMilestones" class="label-control">عدد مراحل الدفع</label>
                        <input type="number" class="form-control" name="numberOfMilestones" min="1" max="6"
                        formControlName="numberOfMilestones" (ngModelChange)="milestones()"
                         placeholder="عدد مراحل الدفع"
                         required
                      [class.is-valid]="OfferData.get('numberOfMilestones')?.valid"
                      [class.is-invalid]="OfferData.get('numberOfMilestones')?.invalid &&
                      OfferData.get('numberOfMilestones')?.touched" >

                      <div
                      class="alert alert-danger"
                      [hidden]="OfferData.get('numberOfMilestones')?.valid ||OfferData.get('numberOfMilestones')?.untouched" >
                      <span *ngIf="OfferData.get('numberOfMilestones')?.errors?.['required']
                      " >يجب ادخال عددمراحل اقل من 7 </span>

                    </div>
                      </div>


                      <ng-container *ngFor="let stone of  numberofMilestones">

                        <div class="col-lg-1 form-group  stage">
                          <label for="stage" class="label-control">#{{stone}}</label>
                        </div>


                        <div class="col-lg-3  form-group  mt-5">
                          <div class="input-group">
                            <input type="text" class="form-control mx-0" name="percentage{{stone}}" placeholder="50%"
                            formControlName="precentage"
                            (ngModelChange)="MilestoneCost(stone,this.OfferData.get('precentage').value)">
                            <span  class="input-group-text-right px-3 text-white pt-3" style="background-color:#004057;">%</span>
                          </div>


                        </div>

                        <div class="col-lg-4 form-group mt-5">
                          <div class="input-group">
                            <input type="text" class="form-control" name="percentage" placeholder="500 ريال">
                          <span class="input-group-text-right px-3 text-white pt-2" style="background-color:#004057;">ريال</span>
                          </div>

                        </div>

                        <div class="col-lg-4 form-group mt-5">
                          <select class="form-select" (change)="workId($event,stone)" required>

                            <option disabled selected >اختر</option>

                            <ng-container *ngIf="stone==1">
                              <option [value]="8">دفعه مقدمه</option>
                            </ng-container>


                            <option [value]="9" *ngIf="stone== numberofMilestones.length">بعد الانتهاء</option>

                            <ng-container *ngFor="let work of RequiredWorks">

                                <option [value]="work.id">{{work.name}}</option>


                            </ng-container>

                          </select>
                        </div>

                      </ng-container >


                      <div class="col-lg-12 form-group mt-3">
                        <label for="message">تواصل مع المسؤل</label>
                        <textarea name="" id=""  name="message"
                        formControlName="message"
                        placeholder="الرساله"></textarea>
                      </div>

                    </div>

                    <input type="submit" class="btn col-3 mt-4 mb-2" value="ارسال"

                    [disabled]="OfferData.get('cost')?.errors?.['required'] ||
                       OfferData.get('period')?.errors?.['required']||
                       OfferData.get('numberOfMilestones')?.errors?.['required']
                       "

                    >

                </div>
                </form>


              </div>
              </div>

            </div>
             </div>



             <div class="col-12 mt-3">

              <div class="card ">
              <div id="accordion">
              <h2>
                <button class="btn btn-accordion w-100" type="button"
                data-target="#item2" data-toggle="collapse" >التزامات المقاول</button>
              </h2>

              <div class="collapse hide" id="item2" data-parent="#accordian">

                <h6 class="dotted-line mt-2 text-center" style="color:gray;"></h6>

                <form action="">
                  <div class="card-3">
                      <div class="row">

                        <input type="hidden" formControlName="projectId" name="projectId" [value]="select">

                        <div class="col-12 form-group mt-3">
                          <textarea name="" id=""  name="message"
                          formControlName="message"
                           style="height: 100%;
                          padding-bottom:10%;"></textarea>
                        </div>

                      </div>

                      <input type="submit" class="btn col-3 mt-4 mb-3" value="ارسال">

                  </div>
                  </form>


              </div>
              </div>

            </div>
             </div>






             <div class="col-12 mt-3">

              <div class="card ">
             <div id="accordion">
              <h2>
                <button class="btn btn-accordion w-100" type="button"
                data-target="#item3" data-toggle="collapse" >الشروط</button>
              </h2>

              <div class="collapse hide" id="item3" data-parent="#accordian">

                <h6 class="dotted-line mt-2 text-center" style="color:gray;"></h6>

                <form action="">
                  <div class="card-3">
                      <div class="row">

                        <input type="hidden" formControlName="projectId" name="projectId" [value]="select">

                        <div class="col-12 form-group mt-3">
                          <textarea name="" id=""  name="message"
                          formControlName="message"
                          style="height: 100%;
                          padding-bottom:10%;"
                          placeholder="شروط العقد"></textarea>
                        </div>

                        <div class="col-12 form-group mt-3">
                          <textarea name="" id=""  name="message"
                          formControlName="message"
                          style="height: 100%;
                          padding-bottom:10%;"
                          placeholder="تسويه النزاعات"></textarea>
                        </div>

                      </div>

                      <input type="submit" class="btn col-3 mt-4 mb-3" value="تأكيد">

                  </div>
                  </form>


              </div>
              </div>

            </div>
             </div>



             <div class="col-12 mt-3">

              <div class="card card-4">
             <div id="accordion">
              <h2>
                <button class="btn btn-accordion w-100" type="button"
                data-target="#item4" data-toggle="collapse" >طريقه التحجيم</button>
              </h2>

              <div class="collapse hide" id="item4" data-parent="#accordian">

                <h6 class="dotted-line mt-2 text-center" style="color:gray;"></h6>

                <form action="">
                  <div class="card-3">
                      <div class="row">

                        <input type="hidden" formControlName="projectId" name="projectId" [value]="select">

                        <div class="col-12 form-group mt-3">
                          <textarea name="" id=""  name="message"
                          formControlName="message"
                          style="height: 100%;
                          padding-bottom:10%;"
                             ></textarea>
                        </div>

                      </div>

                      <input type="submit" class="btn col-3 mt-4 mb-3" value="تأكيد">

                  </div>
                  </form>


              </div>
              </div>

            </div>
             </div>




             <div class="col-12 mt-3">

              <div class="card card-4">
             <div id="accordion">
              <h2>
                <button class="btn btn-accordion w-100" type="button"
                data-target="#item5" data-toggle="collapse" >مواصفات المواد المستخدمه</button>
              </h2>

              <div class="collapse hide" id="item5" data-parent="#accordian">

                <h6 class="dotted-line mt-2 text-center" style="color:gray;"></h6>

                <form action="">
                  <div class="card-3">
                      <div class="row">

                        <input type="hidden" formControlName="projectId" name="projectId" [value]="select">

                        <div class="col-12 mt-3 form-group">
                          <select name="" id="" class="form-select pt-3 pb-3">
                            <option value="" disabled selected>اختر نوع المواد المستخدمه</option>
                          </select>

                        </div>
                        <div class="col-lg-6 form-group mt-4">
                          <input type="text" class="form-control"
                           placeholder="اسم الخامه" >
                        </div>


                        <div class="col-lg-6 form-group mt-4" >
                          <input type="number" class="form-control cost" name="tcost"
                          formControlName="tcost"
                           placeholder="السعر" >
                        </div>

                        <div class="col-12 form-group mt-4">
                          <textarea name="" id=""  name="message"
                          formControlName="message"
                          style="height: 100%;
                          padding-bottom:10%;"
                          placeholder="الوصف"
                             ></textarea>
                        </div>

                      </div>

                      <input type="submit" class="btn col-3 mt-4 mb-3" value="تأكيد">

                  </div>
                  </form>


              </div>
              </div>

            </div>
             </div>

            </div>

        </ng-container>
      </div>


    </div>

  </div>




